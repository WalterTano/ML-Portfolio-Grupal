{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/UT3-TA4/","result":{"data":{"datoCmsBlogpost":{"id":"DatoCmsBlogpost-KVADJlK9RGibimityUuWcQ","slug":"UT3-TA4","title":"Caso de estudio: Predicción de segundos ataques al corazón","excerpt":"","date":null,"html":"# Aplicación del modelo de Regresión Logística para predecir un segundo posible ataque al corazón en pacientes cardíacos\n\n## Descripción\nEste proyecto consiste en generar un modelo de IA llamado Regresión Logística, cuyo objetivo es predecir si un paciente que haya tenido un ataque cardíaco, podría recibir un segundo. Este modelo se planea implementar para ser utilizado por cardiólogos, los cuales, con su ayuda, pueden decidir distintos tratamientos para sus pacientes, como medidas de prevención de un próximo ataque cardíaco.\n\nPara esto tenemos dos datasets:\n* Un dataset de entrenamiento, donde hay personas que ya tuvieron un ataque cardíaco e indica, entre otros atributos, si tuvieron o no, otro ataque.\n* Un dataset de evaluación, donde hay personas que solo tuvieron un ataque cardíaco y se intenta predecir si tendrán otro, en base a sus atributos y al modelo construído a partir del dataset de entrenamiento.\n\nEstos datasets tienen los siguientes atributos:\n\n* **Edad**: Representa la edad en años del paciente, redondeada al número más cercano.\n* **Estado_civil**: Representa, mediante un número, el estado civil de la persona: 0 = soltero, 1 = casado, 2 = divorciado, 3 = viudo.\n* **Sexo**: Representa, mediante un número, el sexo de la persona: 0 = femenino, 1 = masculino.\n* **Categoria_Peso**: Representa, mediante un número, la categoría de IMC de la persona: 0 = normal, 1 = sobrepeso, 2 = obeso (no hay ejemplos por debajo del IMC normal).\n* **Colesterol**: Nivel de colesterol de la persona durante su primer ataque cardíaco, en miligramos por decilitro\n* **Manejo_stress**: Representa, mediante un número, si la persona participó en cursos de manejo del estrés: 0 = no, 1 = sí\n* **Trat_ansiedad**: Representa, mediante un número, el nivel natural de ansiedad de la persona y su capacidad de manejo del estrés: entero de 0 a 100\n* <span style=\"font-weight: bold; text-decoration: underline\">2do_Ataque_Corazon</span>: Indica si la persona ha recibido un segundo ataque cardíaco. Se representa con \"Si\" o \"No\". Este atributo solo se encuentra presente en el dataset de entrenamiento.\n\n---\n\n## Marco teórico\n\nLa predicción de un segundo posible ataque cardíaco se realiza en base a un valor de un\n`p = P(Y = 1)`, donde `Y` es una variable aleatoria de Bernoulli (`p`), definida `Y = 1` en caso de la persona no tenga un segundo ataque cardíaco, `Y = 0`, en caso de que la persona sí lo tenga.\n\nEl valor `p = P(Y = 1)` se calcula en base a los datos observados `x = (x1, ..., xp)` por eso `p = p(x)`.\n\nPara logar un valor de `p(x)` que esté entre 0 y 1 se plantea aplicar la siguiente transformación llamada `Logit(p(x)) = Log(p(x) / (1 - p(x)))` donde `Logit(p(x))` toma valores entre menos infinito y más infinito (conforme `p(x)` toma valores hacia 0 o 1, respectivamente). Con lo cual, un modelo para la transformación `Logit` sobre `p(x)` podría ser `Logit(p(x)) = Log(p(x) / (1 - p(x))) = a * x + b` o en términos de `p(x) = exp(a * x + b) / (1 + exp(a * x + b)) = 1 / (1 + exp(-(a * x + b)))`.\n\nEn nuestro caso, la respuesta `Y = 1` se corresponde con el evento \"no tener un segundo ataque cardíaco\", con lo cual, un `p(x1, ..., xp)` (equivalente a `P(Y = 1)`) cercano a 1, es un buen pronóstico. En el modelo, esto se representa mediante el atributo `Confidence(No)`, o sea, la probabilidad de que el paciente no reciba un segundo ataque cardíaco.\n\n---\n\n## RapidMiner\n\nPara realizar este proyecto que implica crear un modelo de Regresión Logística, se utilizó RapidMiner, una aplicación para desarrollo de modelos de IA de uso industrial. El resultado es el siguiente:\n\nProceso de RapidMiner:\n![](https://www.datocms-assets.com/109010/1698872811-ut3-ta4-proceso-1.png)\n\nModelo de regresión logística:\n![](https://www.datocms-assets.com/109010/1698872893-ut3-ta4-modelo.png)\n\nParte del dataset de evaluación con las predicciones:\n![](https://www.datocms-assets.com/109010/1698872932-ut3-ta4-dataset_evaluacion.png)\n![](https://www.datocms-assets.com/109010/1698872970-ut3-ta4-estadisticas_1.png)\n![](https://www.datocms-assets.com/109010/1698872978-ut3-ta4-estadisticas_2.png)\n\nDentro de las predicciones, se puede observar que 350 de los 690 pacientes del dataset de evaluación, tienen mayor probabilidad se tener un segundo ataque cardíaco. Veamos un ejemplo del dataset de evaluación:\n![](https://www.datocms-assets.com/109010/1698873030-ut3-ta4-ejemplo1.png)\n\nComo se puede ver, el modelo categoriza a este paciente como no propenso a recibir un segundo ataque al corazón. Sin embargo, viendo el atributo confidence(Si), se puede notar que reconoce una probabilidad del 49.7% de que sí lo reciba. Con esta probabilidad, lo mejor sería asumir que está en una posición de riesgo de tener un segundo ataque al corazón y tomar medidas para evitarlo. \n\nEl modelo, en sí, calcula las probabilidades de que un paciente reciba un segundo ataque al corazón o no. Luego, si la probabilidad de que ocurra es mayor o igual que 0,5, se considera como un caso positivo. Sin embargo, hay que tener el cuenta los riesgos de asumir cualquiera de los dos casos posibles, y las probabilidades en cuestión, dependiendo del contexto de la predicción.\n\nPara determinar la performance del modelo, conviene generar un nuevo par de datasets de entrenamiento y evaluación, a partir del dataset de entrenamiento original, de la siguiente forma:\n![](https://www.datocms-assets.com/109010/1698873105-ut3-ta4-proceso-2.png)\n![](https://www.datocms-assets.com/109010/1698873114-ut3-ta4-proceso-2-1.png)\n\nMatriz de confusión:\n![](https://www.datocms-assets.com/109010/1698873159-ut3-ta4-matriz_confusion.png)\n\nEsta es la Matriz de Confusión, una herramienta que muestra información respecto al desempeño del modelo. Más concretamente, muestra la cantidad de veces que el modelo predijo que el paciente iba a tener un segundo ataque al corazón y acertó. Lo mismo con los casos negativos. Asimismo muestra los falsos positivos: en el caso de este modelo, son seis pacientes a los cuales se les predice que van a tener un segundo ataque, pero no lo tienen. Al igual que muestra los falsos negativos, que son cinco personas que tienen un segundo ataque cardíaco, pero el modelo no lo pudo predecir.\n\nDentro de los atributos que contribuyen a calcular la probabilidad de un segundo ataque al corazón, el atributo \"Categoria_Peso\", que representa el IMC del paciente, es el que más aporta a esta, con un P-valor de 0 y un coeficiente de -4,056, cuyo signo negativo se interpreta como que un aumento del valor del atributo implica que la función `Logit(p(x1, x2, ...))` tienda a disminuir, tendiendo a 0 la probabilidad de no tener un segundo ataque cardíaco (`p(x1, x2, ...)`), o lo que es lo mismo, tendiendo a 1 la probabilidad de sí tenerlo.","isMarkdown":true,"image":{"url":"https://www.datocms-assets.com/109010/1698871931-doctor.jpg?auto=format","gatsbyImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/109010/1698871931-doctor.jpg?auto=format&w=3072","srcSet":"https://www.datocms-assets.com/109010/1698871931-doctor.jpg?auto=format&dpr=0.25&w=3072 768w,\nhttps://www.datocms-assets.com/109010/1698871931-doctor.jpg?auto=format&dpr=0.5&w=3072 1536w,\nhttps://www.datocms-assets.com/109010/1698871931-doctor.jpg?auto=format&w=3072 3072w","sizes":"(min-width: 3072px) 3072px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBgoICAgLFA0LDhgXFQ0ZGigPDg4YFx8ZGBYVFhUmHysjGh0oHRUWJDUlKC0vMjIyHSI4PTcwPCsxMi8BCgsLDg0OHA0KHDscFhwvLy8vLy8vNS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIAA4AGAMBIgACEQEDEQH/xAAYAAACAwAAAAAAAAAAAAAAAAAABQMEBv/EAB4QAAEFAAIDAAAAAAAAAAAAAAEAAgMEBRFBEiEi/8QAFwEAAwEAAAAAAAAAAAAAAAAAAQIDAP/EABgRAQEAAwAAAAAAAAAAAAAAAAIAARIT/9oADAMBAAIRAxEAPwDQRCV7AQFPpX54M3gDpUKGi8xe2phdkE1D6b0kyFUDMkzdCxIDyEIryCFp8WoW55jub//Z"},"width":3072,"height":1728},"alt":null}}},"pageContext":{"id":"DatoCmsBlogpost-KVADJlK9RGibimityUuWcQ"}},"staticQueryHashes":["1987388502","3342712670"],"slicesMap":{"footer":"footer","header":"header"}}